<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="./css/style.min.css">
    <link rel="stylesheet" href="./css/component.css">
    <script src="./js/plug/jquery.js"></script>
    <script src="./js/index.js"></script>
    <!-- <script src="./js/indexDB.js"></script> -->
    <title>打印页</title>
    <style type="text/css" media="print">
        .noprint {
            display: none;
        }
        
        .graph>div {
            transform: scale(1) !important;
        }
        
        .sum .graph>div>div:first-child {
            visibility: hidden;
        }
        
        .graph>div input {
            font-size: 12px;
        }
        
        #printContent .list .graph {
            padding: 5px 0;
        }
    </style>
</head>

<body>
    <div class="operation noprint">
        <input type="button" value="打印" onclick="m_print()">
    </div>
    <!--startprint-->
    <div id="printContent" class="content">
        <div class="list list-left">
            <table>
                <thead>
                    <tr>
                        <th>直径</th>
                        <th>图形</th>
                        <th>开料长度</th>
                        <th>条数</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        <div class="list list-right">
            <table>
                <thead>
                    <tr>
                        <th>直径</th>
                        <th>图形</th>
                        <th>开料长度</th>
                        <th>条数</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
    <!--endprint-->
</body>
<script>
    window.onLoad = showList();

    function showList() {
        var allData = JSON.parse(window.localStorage.global);
        var appendStr = ""; //tbody内总DOM
        var dotitem = ""; //图形数字细节DOM
        var dotStr = ""; //图形数字细节DOM


        var completion = 0;
        completion = allData.length % 30 > 0 ? (parseInt(allData.length / 30) + 1) * 30 : (parseInt(allData.length / 30)) * 30;
        console.log(completion);

        for (var i = 0; i < completion; i++) {
            if (i < allData.length) {
                console.log(typeof(allData[i].orderNumber));
                if (allData[i].orderNumber == '') {
                    // 拼接数据DOM
                    appendStr = "<tr class='sum'><td  class ='graph' colspan='4'><div><div class='image' style='z-index:-1'><img src='./images/0.jpg'></div><div>直径为" + allData[i].diameter + "的重量为" + allData[i].weight + "米*" + allData[i].coefficient + "公斤=" + allData[i].specSum + "公斤</div></div></td></tr>"
                } else if (typeof(allData[i].orderNumber) == 'number') {
                    for (var j = 0; j < allData[i].detailsKey.length; j++) {
                        dotitem = "<input class='" + allData[i].detailsKey[j] + "' type='text' disabled value='" + allData[i].detailsValue[j] + "'>"
                        dotStr += dotitem;
                    }
                    // 拼接数据DOM
                    appendStr = "<tr><td class = 'diameter'>" + allData[i].diameter +
                        "</td><td class = 'graph'><div class='image'><img src='./images/" + allData[i].graphical +
                        ".jpg'>" + dotStr + "</div></td><td class = 'length'>" + allData[i].length +
                        "</td><td class = 'branches'>" + allData[i].branches +
                        "</td></tr>"
                }
            } else {
                appendStr = "<tr><td class = 'diameter'></td><td class = 'graph'><div class='image'><img src='./images/0.jpg'></div></td><td class = 'length'></td><td class = 'branches'></td></tr>"
            }

            if ((parseInt(i / 15) + 2) % 2 == 0) {
                $('.list-left tbody').append(appendStr);
            } else {
                $('.list-right tbody').append(appendStr);
            }
            dotitem = '';
            dotStr = '';
        }

        // var oHeight = $(".list tbody tr").height() + 30;
        // $(".sum").css({
        //     height: oHeight + 'px'
        // })

    }
</script>

</html>